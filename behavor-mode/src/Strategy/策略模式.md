# 策略模式
## 场景
1. 经典例子：
    导航软件中的路径规划功能：
    例如高德导航，选择好初始地点和目的地之后，可以使用驾车、骑行、步行等路径规划方式，最终得到一条路径。
    不同类型的路径采取不同的算法方式计算实现。
2. 项目例子
    对于评测功能，要维护不同的多种评测算法（Common，SPJ，interval 交互评测）

## 概念

**上下文**： （Context） 维护指向具体策略的引用， 且仅通过策略接口与该对象进行交流。

1. 当上下文需要运行算法时， 它会在其已连接的策略对象上调用执行方法。 上下文不清楚其所涉及的策略类型与算法的执行方式。

**策略**：策略（Strategy） 接口是所有具体策略的通用接口， 它声明了一个上下文用于执行策略的方法。

**具体策略**：实现了上下文所用算法的各种不同变体。

**客户端**：（Client） 会创建一个特定策略对象并将其传递给上下文。 上下文则会提供一个设置器以便客户端在运行时替换相关联的策略。

## 优缺

优点：

-  你可以在运行时切换对象内的算法。
-  你可以将算法的实现和使用算法的代码隔离开来。
-  你可以使用组合来代替继承。
-  *开闭原则*。 你无需对上下文进行修改就能够引入新的策略。

缺点：

- 如果你的算法极少发生改变， 那么没有任何理由引入新的类和接口。 使用该模式只会让程序过于复杂。
-  客户端必须知晓策略间的不同——它需要选择合适的策略。
-  许多现代编程语言支持函数类型功能， 允许你在一组匿名函数中实现不同版本的算法。 这样， 你使用这些函数的方式就和使用策略对象时完全相同， 无需借助额外的类和接口来保持代码简洁。

## 发散

### 1. why not factory

为什么不使用工厂模式。首先要明白创建型设计模式和行为设计模式之间的区别。

1. 创建型模式提供了创建对象的机制， 能够提升已有代码的灵活性和可复用性。
2. 行为模式负责对象间的高效沟通和职责委派。

如果使用简单工厂方法模式来实现上述内容：就意味着要根据不同的评测策略定义对应的一个产品类，产品工厂。

1. 带来更加复杂的体系逻辑。修改工厂代码、产品代码。并且可能由于语境改变，要对工厂模式做一些修改。
2. 策略转换的粒度是创建一个对象。而策略模式从更小的粒度，切换接口，避免了新的策略模式接口对象的转换。
3. 策略模式下，只需要添加一个策略类即可。更加轻量简洁。
4. 简单工厂模式适合创建复杂的对象。而策略模式只关注了给定接口规范下的算法策略的实现，更具有规性，并且更加简洁。

### gpt:

简单工厂模式和策略模式虽然看起来有一定相似性，都涉及对象的创建和某些行为的动态选择，但它们在设计意图、结构和使用场景上有着显著的区别。

要理解两者的差异，可以从以下几个角度来感受：

#### 1. **设计意图**：
   - **简单工厂模式**：其主要目的是根据条件创建不同的对象，通常是一组相关的类，工厂负责封装创建逻辑。简单工厂的核心是“**创建对象**”。
   - **策略模式**：其目的是将不同的算法或行为封装在不同的策略类中，允许在运行时选择不同的策略实现。策略模式的核心是“**行为的动态选择**”，而不一定涉及对象的创建。

   **核心区别**：简单工厂专注于对象的创建，而策略模式专注于行为的选择和切换。

#### 2. **结构与职责分配**：
   - **简单工厂模式**：工厂类是创建对象的关键点，客户端通过工厂获取对象，工厂封装了具体的对象创建逻辑。
   - **策略模式**：包含一个上下文类（Context），它持有一个策略接口，具体的策略实现由不同的策略类实现，客户端可以动态替换这些策略。

   **核心区别**：在策略模式中，客户端和上下文分离了具体算法的选择，而简单工厂的核心责任是在工厂中选择对象。

####  3. **扩展性**：
   - **简单工厂模式**：由于工厂类集中了所有对象创建逻辑，如果要增加新的产品类型，通常需要修改工厂代码，因此扩展性较差（违反开闭原则）。
   - **策略模式**：每个策略类实现了策略接口，如果增加新的策略类，只需要实现策略接口，不需要修改上下文类，因此扩展性较好。

   **核心区别**：策略模式在增加新策略时更加开放和灵活，而简单工厂通常要修改已有的代码。

#### 4. **应用场景**：
   - **简单工厂模式**：适用于根据条件决定创建哪个对象的场景，常用于创建逻辑较为复杂的对象。
   - **策略模式**：适用于在不同条件下切换算法或行为的场景，通常策略之间可以自由替换而不影响上下文的其他部分。

   **核心区别**：简单工厂解决的是对象创建的复杂性问题，而策略模式解决的是算法的动态切换问题。

#### 总结感受：
- 如果你的主要需求是根据条件创建不同的对象，并且对象的创建逻辑复杂，那么使用简单工厂模式可能更合适。
- 如果你的需求是根据条件动态切换行为或算法，并且这些算法或行为彼此独立，策略模式是更好的选择。

你可以通过以下问题来帮助区分两者：
- **我需要创建复杂的对象吗？** 是 -> 简单工厂模式。
- **我需要动态切换行为或算法吗？** 是 -> 策略模式。 

这两者虽然可以在一定场景下互相替代，但各自的关注点是不同的。



